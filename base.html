<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gerenciamento de Frota</title>

    <!-- Bootstrap 5 CSS (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
      body { background: #f6f8fa; }
      .sidebar { width: 240px; position: fixed; height:100vh; background: #fff; border-right: 1px solid #eee; padding: 24px; }
      .content { margin-left: 260px; padding: 28px; }
      .card-status-voando { border-left: 4px solid #2bb6ff; }
      .card-status-manutencao { background:#fff8e6; border:1px solid #f0dca8; }
      .aero-card { margin-bottom: 18px; }
      .small-muted { color:#7b8794; font-size:0.9rem; }
      .badge-programada { background:#ffdca8; color:#7a5600; border-radius:10px; padding:4px 8px; font-size:0.8rem; }
    </style>
  </head>
  <body>
    <div class="sidebar">
      <h5>✈️ Gerenciamento<br/>de Frota</h5>
      <hr/>
      <div class="list-group">
        <a href="{{ url_for('dashboard') }}" class="list-group-item list-group-item-action active">Dashboard</a>
        <a href="{{ url_for('frota') }}" class="list-group-item list-group-item-action">Frota</a>
      </div>
      <div style="position:absolute; bottom:20px; left:24px;">
        <small class="text-muted">© Seu App</small>
      </div>
    </div>

    <div class="content">
      {% block content %}{% endblock %}
    </div>

    <!-- Bootstrap JS bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Mini JS para abrir modais dinamicamente -->
    <script>
      function openModalById(id){
        var el = document.getElementById(id)
        if(!el) return;
        var modal = new bootstrap.Modal(el)
        modal.show()
      }
      // helper para preencher form de atualizar
      function preencherAtualizar(data){
        // data = objeto JSON com campos da aeronave
        document.getElementById('upd_id').value = data.id;
        document.getElementById('upd_matricula').value = data.matricula;
        // status radio
        var radios = document.querySelectorAll('input[name="status_atual"]');
        radios.forEach(r => { if(r.value === data.status_atual) r.checked = true; else r.checked = false; });
        document.getElementById('upd_localizacao').value = data.localizacao_atual || '';
        document.getElementById('upd_comandante').value = data.comandante || '';
        document.getElementById('upd_copiloto').value = data.copiloto || '';
        document.getElementById('upd_mecanico').value = data.mecanico || '';
        document.getElementById('upd_missao').value = data.missao || '';
        openModalById('modalAtualizar');
      }
      // buscar aeronave via API
      async function fetchAeronave(id){
        const res = await fetch('/api/aeronaves/' + id);
        const json = await res.json();
        return json;
      }
      // abrir atualizar com fetch
      function abrirAtualizar(id){
        fetchAeronave(id).then(d=> preencherAtualizar(d));
      }
    </script>
  </body>
</html>
